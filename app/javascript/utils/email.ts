import Mailcheck from "mailcheck";

const REGEX =
  /^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3})|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/u;
export const isValidEmail = (possiblyEmail: string): boolean =>
  REGEX.test(possiblyEmail) && possiblyEmail.length <= 255;

export const checkEmailForTypos = (email: string, cb: (suggestion: MailcheckModule.ISuggestion) => void) => {
  Mailcheck.run({
    email,
    domains: POPULAR_EMAIL_HOST_DOMAINS,
    topLevelDomains: POPULAR_TOP_LEVEL_DOMAINS,
    suggested: (suggestion: MailcheckModule.ISuggestion) => {
      cb(suggestion);
    },
  });
};

const POPULAR_EMAIL_HOST_DOMAINS = [
  "126.com",
  "163.com",
  "21cn.com",
  "alice.it",
  "aliyun.com",
  "aol.com",
  "aol.it",
  "arnet.com.ar",
  "att.net",
  "bellsouth.net",
  "blueyonder.co.uk",
  "bol.com.br",
  "bt.com",
  "btinternet.com",
  "charter.net",
  "comcast.net",
  "cox.net",
  "daum.net",
  "earthlink.net",
  "email.com",
  "email.it",
  "facebook.com",
  "fastmail.fm",
  "fibertel.com.ar",
  "foxmail.com",
  "free.fr",
  "freeserve.co.uk",
  "games.com",
  "globo.com",
  "globomail.com",
  "gmail.com",
  "gmx.com",
  "gmx.de",
  "gmx.fr",
  "gmx.net",
  "google.com",
  "googlemail.com",
  "hanmail.net",
  "hey.com",
  "hotmail.be",
  "hotmail.co.uk",
  "hotmail.com",
  "hotmail.com.ar",
  "hotmail.com.br",
  "hotmail.com.mx",
  "hotmail.de",
  "hotmail.es",
  "hotmail.fr",
  "hotmail.it",
  "hush.com",
  "hushmail.com",
  "icloud.com",
  "ig.com.br",
  "iname.com",
  "inbox.com",
  "itelefonica.com.br",
  "juno.com",
  "keemail.me",
  "laposte.net",
  "lavabit.com",
  "libero.it",
  "list.ru",
  "live.be",
  "live.co.uk",
  "live.com",
  "live.com.ar",
  "live.com.mx",
  "live.de",
  "live.fr",
  "live.it",
  "love.com",
  "mac.com",
  "mail.com",
  "mail.ru",
  "me.com",
  "msn.com",
  "nate.com",
  "naver.com",
  "neuf.fr",
  "ntlworld.com",
  "o2.co.uk",
  "oi.com.br",
  "online.de",
  "orange.fr",
  "orange.net",
  "outlook.com",
  "outlook.com.br",
  "pobox.com",
  "poste.it",
  "prodigy.net.mx",
  "protonmail.ch",
  "protonmail.com",
  "qq.com",
  "r7.com",
  "rambler.ru",
  "rocketmail.com",
  "safe-mail.net",
  "sbcglobal.net",
  "sfr.fr",
  "sina.cn",
  "sina.com",
  "sky.com",
  "skynet.be",
  "speedy.com.ar",
  "t-online.de",
  "talktalk.co.uk",
  "telenet.be",
  "teletu.it",
  "terra.com.br",
  "tin.it",
  "tiscali.co.uk",
  "tiscali.it",
  "tuta.io",
  "tutamail.com",
  "tutanota.com",
  "tutanota.de",
  "tvcablenet.be",
  "uol.com.br",
  "verizon.net",
  "virgilio.it",
  "virgin.net",
  "virginmedia.com",
  "voo.be",
  "wanadoo.co.uk",
  "wanadoo.fr",
  "web.de",
  "wow.com",
  "ya.ru",
  "yahoo.co.id",
  "yahoo.co.in",
  "yahoo.co.jp",
  "yahoo.co.kr",
  "yahoo.co.uk",
  "yahoo.com",
  "yahoo.com.ar",
  "yahoo.com.br",
  "yahoo.com.mx",
  "yahoo.com.ph",
  "yahoo.com.sg",
  "yahoo.de",
  "yahoo.fr",
  "yahoo.it",
  "yandex.com",
  "yandex.ru",
  "yeah.net",
  "ygm.com",
  "ymail.com",
  "zipmail.com.br",
  "zoho.com",
];

const POPULAR_TOP_LEVEL_DOMAINS = [
  "ac.uk",
  "at",
  "be",
  "biz",
  "ca",
  "cat",
  "ch",
  "co.il",
  "co.in",
  "co.jp",
  "co.nz",
  "co.uk",
  "com.au",
  "com.tw",
  "com",
  "cz",
  "de",
  "dk",
  "edu",
  "es",
  "eu",
  "fi",
  "fr",
  "gov",
  "gr",
  "hk",
  "hu",
  "ie",
  "in",
  "info",
  "it",
  "jp",
  "kr",
  "me",
  "mil",
  "net.au",
  "net",
  "net",
  "nl",
  "no",
  "org",
  "pl",
  "ro",
  "ru",
  "se",
  "sg",
  "uk",
  "us",
];
